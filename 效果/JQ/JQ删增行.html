<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>表格</title>
    <script src="js/jquery-3.1.1.js"></script>
</head>
<style>
    #mytable{
        width: 1200px;
        border-collapse: collapse;
    }
    tr{
        height: 40px;
    }
    td{
        width: 100px;
    }
</style>
<body>
<table id="mytable">
    <tr>
        <td><input type="checkbox" id="all"></td>
        <td align="center" ><input type="text" value="Num" disabled="disabled"></td>
        <td><input type="userName" disabled="disabled"></td>
        <td><input type="userType" disabled="disabled"></td>
        <td>
            <select name="" id="">
                <option value="admin">admin</option>
                <option value="John">John</option>
                <select>
        </td>
        <td><input type="text" disabled="disabled"></td>

    </tr>
    <tr>
        <td><input type="checkbox" class="aaa" onclick="checkAll()"></td>
        <td align="center"><input type="text" value="1" readonly="readonly" size="2" name="num"></td>
        <td><input type="userName"></td>
        <td><input type="userType"></td>
        <td>
            <select name="" id="">
                <option value="admin">admin</option>
                <option value="John">John</option>
                </select>
        </td>
        <td><input type="text"></td>
        <td><button id="btn" onclick="add()">增行</button>
            <button id="btn1" onclick="del(this)">删行</button>
        </td>

    </tr>
</table>
</body>
<script>
    $(function(){
        $("#all").click(function(){
            $("input[class='aaa']").prop("checked",this.checked);
        });

    });
    function add() {
        var length = $("tr").length;
        if (length <= 15) {
            $("tr:last-child").clone().appendTo($("table"));
            var num = $("tr:last-child").index();
            $("tr:last-child td:nth-of-type(2) input:text").val(num)
        }
    }
    function del(that){
        var length=$("tr").length;
        if(length<=2){
            alert("至少保留两行")
        }else{
            var $parent=$(that).parent();
//           var num=$parent.parent().index();
            $parent.parent().remove();
            $("tr").each(function(index){
                $(this).find("input[name='num']").val(index)
            }) ;
//          for(var i=0;i<$("tr").length;i++){
//              $("tr").eq(i).find(".num").val(i)
//          }
        }

    }
    function checkAll(){
//        if($("input[class='aaa']").length==$("input[class='aaa']:checked").length){
//                $("#all").prop("checked",true);
//            }else{
//                $("#all").prop("checked",false);
//        }
        $("#all").prop("checked",$("input[class='aaa']").length==$("input[class='aaa']:checked").length)
    }
</script>
</html>
